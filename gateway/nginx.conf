# Upstreams remain the same
upstream auth_service { server auth_service_api:8000; }
upstream project_service { server project_service_api:8000; }
upstream model_service { server model_service_api:8000; }
upstream node_service { server node_service_api:8000; }

server {
    listen 80;

    location /static/ {
        alias /vol/static/;
    }

    # --- MS1: Auth Service Routes ---
    location /ms1/ {
        # This strips the /ms1/ prefix before sending to the backend
        proxy_pass http://auth_service/ms1/;
        # This tells Django the original Host was 'localhost'
        proxy_set_header Host $host;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    }

    # --- MS2: Project Service Routes ---
    location /ms2/ {
        proxy_pass http://project_service/ms2/;
        proxy_set_header Host $host;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    }

    # --- MS3: AI Models Service Routes ---
    location /ms3/ {
        proxy_pass http://model_service/ms3/;
        proxy_set_header Host $host;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    }

    # --- MS4: Nodes Service Routes ---
    location /ms4/ {
        proxy_pass http://node_service/ms4/;
        proxy_set_header Host $host;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    }
}